{% extends "./template.html" %}
{% block content %}
{% load static %}
<script type="text/javascript" src="{% static 'NearBeach/javascript/check_dates.js' %}"></script>
<script type="text/javascript" src="{% static 'NearBeach/javascript/expand_sections.js' %}"></script>
<script type="text/javascript" src="{% static 'NearBeach/javascript/project_information.js' %}"></script>
<script type="text/javascript" src="{% static 'NearBeach/javascript/render_documents.js' %}"></script>
<script>
	function on_page_load() {
		initiate_dates();
		render_documents_code = render_documents({{ document_folders_results | safe }}, {{ documents_results | safe }}, null);

		root_folder = document.getElementById("root_folder");
		root_folder.innerHTML = render_documents_code;
	}
</script>

<body onload="on_page_load();">
	<form action="{% url 'project_information' project_results.project_id %}" method="POST" enctype="multipart/form-data">
		<div class="div_content">
			<div class="div_header">
				<h1>Project Information - PRO{{ project_results.project_id }}</h1>
			</div>
			<div class="div_sub_content">

					{% csrf_token %}
					{{ project_information_form.project_name }}<br/>
					{{ project_information_form.project_description }}<br/>
					Organisation - {{ project_results.organisations_id.organisation_name }}<br/>
					Project Status - {{ project_results.project_status }}<br/>
					Project Start - {{ project_information_form.start_date_year }}{{ project_information_form.start_date_month }}{{ project_information_form.start_date_day }} @ {{ project_information_form.start_date_hour }}:{{ project_information_form.start_date_minute }} {{ project_information_form.start_date_meridiems }}<br/>
					Project Finish - {{ project_information_form.finish_date_year }}{{ project_information_form.finish_date_month }}{{ project_information_form.finish_date_day }} @ {{ project_information_form.finish_date_hour }}:{{ project_information_form.finish_date_minute }}{{ project_information_form.finish_date_meridiems }}<br/><br/>
					{{ project_information_form.project_history_text }}
					<input type="submit" name="Save" value="Save"/>
					{% if project_results.project_status == 'New' or prooject_results.project_status == 'Open' %}
						<input type="submit" name="Resolve" value="Resolve Project"/>
					{% endif %}

			</div>
		</div>
		<br/>
		<div class="div_content">
			<div class="div_header" onclick="hide_unhide('div_project_history')">
				<h3>Project History</h3>
			</div>
			<div class="div_sub_content" id="div_project_history" style="display: none;">
				{% if project_history_results %}
					{% for row in project_history_results %}
						<p>{{ row.user_infomation }} - {{ row.user_id }} - {{ row.audit_date }}<br />
						<textarea readonly>{{ row.project_history }}</textarea>
						</p>
					{% endfor %}
				{% else %}
					<p>Currently no history</p>
				{% endif %}
			</div>
		</div>
		<br/>
		<div class="div_content">
			<div class="div_header" onclick="hide_unhide('div_associated_tasks')">
				<h3>Associated Tasks</h3>
			</div>
			<div class="div_sub_content" id="div_associated_tasks" style="display: none;">
				<a href="{% url 'associated_tasks' project_results.project_id %}">Associate Task</a>
				{% if associated_tasks_results %}
						<table>
						<tr class="header"><td>Task Id</td><td>Short Description</td><td>End Date</td></tr>
						{% for associated_task_row in associated_tasks_results %}
							<tr>
							<td><a href="{% url 'task_information' associated_task_row.tasks_id %}">{{ associated_task_row.tasks_id }}</a></td>
							<td>{{ associated_task_row.task_short_description }}</td>
							<td>{{ associated_task_row.task_end_date }}</td>
							</tr>
						{% endfor %}

						</table>
				{% else %}
					<p>Currently no associated history.</p>
				{% endif %}
			</div>
		</div>
		<br/>
		<div class="div_content">
			<div class="div_header" onclick="hide_unhide('div_project_customers')">
				<h3>Project Customers</h3>
			</div>
			<div class="div_sub_content" id="div_project_customers" style="display: none;">
				{% if new_customers_results %}
					<select id="add_customer_select" name="add_customer_select" onchange="enable_disable_add_customer()" >
						<option value="---------" selected>---------</option>
						{% for row in new_customers_results %}
							<option value="{{ row.customer_id }}">{{ row.customer_name }}</option>
						{% endfor %}
					</select>
					<input type="submit" name="add_customer_submit" id="add_customer_submit" value="Add Customers to Project" disabled="disabled">
				{% endif %}
				{% if project_customers_results %}
					<table>
						<tr class="header">
							<td>Customer Name</td>
							<td>Customer Description</td>
							<td>Customer Email</td>
							<td>Customer Campus</td>
							<td>Customer Phone</td>
						</tr>
						{% for row in project_customers_results %}
							<tr>
								<td>{{ row.customer_first_name }} {{ row.customer_last_name }}</td>
								<td>{{ row.customer_description }}</td>
								<td>{{ row.customer_email }}</td>
								<td>{{ row.campus_nickname }}</td>
								<td>{{ row.customer_phone }}</td>
							</tr>
						{% endfor %}
					</table>
				{% else %}
					<br/>Sorry, there seems to be no customers associated with this project.
				{% endif %}
			</div>
		</div>
		<br/>
		<div class="div_content">
			<div class="div_header" onclick="hide_unhide('div_project_costs')">
				<h3>Project Costs</h3>
			</div>
			<div class="div_sub_content" id="div_project_costs" style="display: none;">
				[Content to contain ability to add in extra costs]
			</div>
		</div>
		<br/>
		<div class="div_content">
			<div class="div_header" onclick="hide_unhide('div_project_documents')">
				<h3>Project Documents</h3>
			</div>
			<div class="div_sub_content" id="div_project_documents" style="display: none;">
				[BUTTONS AND CONTENT]

                <a hre="#" onclick="add_new_document()">Add New Document</a>

                <ul>
                    <li>Add Folder</li>
                    <il>Add Document</il>

                </ul>
				<div id="root_folder">
					[FOLDER CONTENT]
				</div>
			</div>
		</div>
    <div id="overlay_new_document" class="overlay_new_document">
        <div>
            <h1>New Document</h1>
            <select id="upload_type">
                <option id="upload">Upload Documentation</option>
                <option id="link">Link Documentation</option>
            </select>
            <div id="overlay_upload">
                <p>Please upload a file and press submit</p>
				{{ project_information_form.document }}

            </div>
            <div id="overlay_link" hidden="True">
                <p>Please include the URL to the cloud document</p>
                <b>[CREATE A SIMPLE FORM FIELD]</b>
				{{ project_information_form.document_url_location }}
            </div>
			{{ project_information_form.document_description }}
            <button id="new_document" name="new_document">Submit</button>
            <a href="#" onclick="add_new_document()">Cancel</a>
        </div>
    </div>
	</form>
</body>
{% endblock %}
