{% extends "./template.html" %}
{% block content %}
{% load static %}
<body>
    <form action="{% url 'opportunity_information' opportunity_id %}" method="POST" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="div_content">
            <div class="div_header">
                <h1>Opportunity Information</h1>
            </div>
            <div class="div_sub_content">
                <table>
                    <tr class="header"><td width="250px">Field</td><td>Input</td></tr>
                    {{ opportunity_information_form.as_table }}
                    <tr><td>Lead Source:</td><td>{{ opportunity_results.lead_source_id }}</td></tr>
                    <tr><td>Organisation:</td><td>{{ opportunity_results.organisations_id }}</td></tr>
                    <tr><td>Customer:</td><td>
                        <select>
                            <option value="">-------</option>
                            {% for row in customer_results %}

                                {% if row.customer_id == opportunity_results.customer_id.customer_id %}
                                    <option value="{{ row.customer_id }}" selected>
                                {% else %}
                                    <option value="{{ row.customer_id }}">
                                {% endif %}
                                {{ row.customer_first_name }} {{ row.customer_last_name }}</option>
                            {% endfor %}
                        </select>
                    </td></tr>
                </table>
                <input type="submit" name="submit_contact" value="Update"/>
            </div>
        </div>
        <br/>
        <div class="div_content">
            <div class="div_header">
                <h4>To Do</h4>
            </div>
            <div class="div_sub_content">
                << add in the ability to create the next next step >><br/>
                << add the list of next steps here >>
            </div>
        </div>
        <br/>
        <div class="div_content">
            <div class="div_header">
                <h3>Associated Projects & Tasks</h3>
            </div>
            <div class="div_sub_content">
                <ul>
                    <li><a href="#">Create New Project</a></li>
                    <li><a href="#">Create New Task</a></li>
                </ul>
                <h4>Assigned Projects</h4>
                {% if project_results %}
                    <table>
                        <tr class="header">
                            <td>Project ID</td>
                            <td>Project Name</td>
                            <td>Project End Date</td>
                            <td>Project Status</td>
                        </tr>
                        {% for row in project_results %}
                            <tr>
                                <td><a href="#">PRO{{ row.project_id }}</a></td>
                                <td>{{ row.project_name }}</td>
                                <td>{{ row.project_end_date }}</td>
                                <td>{{ row.project_status }}</td>
                            </tr>
                        {% endfor %}
                    </table>
                {% else %}
                    <p>There are no associated projects. Please create a new project</p>
                {% endif %}
                <br/>
                <h4>Assigned Tasks</h4>
                {% if task_results %}
                    <table>
                        <tr class="header">
                            <td>Task ID</td>
                            <td>Project Name</td>
                            <td>Project End Date</td>
                            <td>Project Status</td>
                        </tr>
                        {% for row in task_results %}
                            <tr>
                                <td><a href="#">TASK{{ row.tasks_id }}</a></td>
                                <td>{{ row.task_short_description }}</td>
                                <td>{{ row.task_end_date }}</td>
                                <td>{{ row.task_status }}</td>
                            </tr>
                        {% endfor %}
                    </table>
                {% else %}
                    <p>There are no associated tasks. Please create a new task</p>
                {% endif %}
            </div>
        </div>
    </form>
</body>
{% endblock %}